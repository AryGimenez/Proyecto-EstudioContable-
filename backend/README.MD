# Backend - Sistema de GestiÃ³n de Pagos y Alertas

Este backend estÃ¡ desarrollado con **FastAPI** y **SQLAlchemy**. Gestiona usuarios, clientes, pagos, depÃ³sitos e impuestos, proporcionando una API REST segura y escalable.

---

## Estructura de Carpetas

```
backend/
â”‚
â”œâ”€â”€ config.py
â”œâ”€â”€ database.py
â”œâ”€â”€ dependencies.py
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ dockerfile
â”œâ”€â”€ main.py
â”œâ”€â”€ security.py
â”œâ”€â”€ utils.py
â”‚
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ cliente.py
â”‚   â”œâ”€â”€ deposito.py
â”‚   â”œâ”€â”€ impuesto.py
â”‚   â”œâ”€â”€ pago.py
â”‚   â”œâ”€â”€ password_reset_request.py
â”‚   â””â”€â”€ user.py
â”‚
â”œâ”€â”€ router/
â”‚   â”œâ”€â”€ auth.py
â”‚   â”œâ”€â”€ clientes.py
â”‚   â”œâ”€â”€ depositos.py
â”‚   â”œâ”€â”€ impuestos.py
â”‚   â”œâ”€â”€ pagos.py
â”‚   â””â”€â”€ user.py
â”‚
â”œâ”€â”€ schemas/
â”‚   â”œâ”€â”€ auth.py
â”‚   â”œâ”€â”€ cliente.py
â”‚   â”œâ”€â”€ config.py
â”‚   â”œâ”€â”€ deposito.py
â”‚   â”œâ”€â”€ impuesto.py
â”‚   â”œâ”€â”€ pago.py
â”‚   â””â”€â”€ user.py
â”‚
â””â”€â”€ FastApi/
    â”œâ”€â”€ main.py
    â””â”€â”€ router/
        â”œâ”€â”€ auth.py
        â”œâ”€â”€ reauth.py
        â””â”€â”€ users.py
```

---

## DescripciÃ³n de Archivos

### Archivos Principales

- **config.py**  
  ConfiguraciÃ³n global del proyecto (variables de entorno, claves, rutas).

- **database.py**  
  ConfiguraciÃ³n y conexiÃ³n a la base de datos con SQLAlchemy.

- **dependencies.py**  
  Dependencias reutilizables para los endpoints (sesiÃ³n de BD, autenticaciÃ³n).

- **main.py**  
  Punto de entrada de la aplicaciÃ³n FastAPI. Inicializa la app, routers y middlewares.

- **security.py**  
  Funciones de seguridad: manejo de contraseÃ±as y tokens JWT.

- **utils.py**  
  Funciones auxiliares y utilitarias para el backend.

---

### Carpeta `models/`

Modelos ORM que representan las tablas de la base de datos:

- **cliente.py**: Modelo de cliente.
- **deposito.py**: Modelo de depÃ³sito.
- **impuesto.py**: Modelo de impuesto.
- **pago.py**: Modelo de pago.
- **password_reset_request.py**: Solicitudes de restablecimiento de contraseÃ±a.
- **user.py**: Modelo de usuario.

---

### Carpeta `router/`

Endpoints de la API REST:

- **auth.py**: AutenticaciÃ³n (login, registro, recuperaciÃ³n).
- **clientes.py**: CRUD de clientes.
- **depositos.py**: CRUD de depÃ³sitos.
- **impuestos.py**: CRUD de impuestos.
- **pagos.py**: CRUD de pagos.
- **user.py**: GestiÃ³n de usuarios.

---

### Carpeta `schemas/`

Esquemas Pydantic para validaciÃ³n y serializaciÃ³n de datos:

- **auth.py**: Esquemas de autenticaciÃ³n.
- **cliente.py**: Esquemas de clientes.
- **config.py**: Esquemas de configuraciÃ³n.
- **deposito.py**: Esquemas de depÃ³sitos.
- **impuesto.py**: Esquemas de impuestos.
- **pago.py**: Esquemas de pagos.
- **user.py**: Esquemas de usuarios.

---

### Carpeta `FastApi/`

Sub-aplicaciÃ³n o mÃ³dulo adicional:

- **main.py**: Punto de entrada de la sub-aplicaciÃ³n.
- **router/auth.py**: Endpoints de autenticaciÃ³n.
- **router/reauth.py**: Endpoints de re-autenticaciÃ³n.
- **router/users.py**: GestiÃ³n de usuarios.

---

## Despliegue

- Utiliza **Docker** y **Docker Compose** para contenerizaciÃ³n y despliegue.
- Configura variables de entorno y credenciales en `config.py` o archivos `.env`.

---

## Requisitos

- Python 3.9+
- FastAPI
- SQLAlchemy
- Uvicorn
- Otros paquetes segÃºn los modelos y rutas (ver `requirements.txt`)

---

## ContribuciÃ³n

Sigue la estructura modular para agregar nuevos modelos, rutas o esquemas.  
AsegÃºrate de documentar y testear tus cambios.

---

## Licencia

Este proyecto estÃ¡ bajo

## Uvicorn

tener el entorno venv para que funcione uvicorn correctamente.

--- Comandos ---

python -m venv venv  <---- crear entorno virtual venv
source venv/bin/activate  # En Linux/Mac
& venv\Scripts\activate.ps1  # En Windows


una vez abierto el venv por primera vez usar 

pip install uvicorn
pip install -r requirements.txt
pip install fastapi <---  instalar fastapi

cuando tengas todo instalado ya podras usar el comando de abajo

uvicorn main:app --reload  <---- comando para abrir el servidor

ðŸ“ DocumentaciÃ³n: ConfiguraciÃ³n y Arranque de Backend
Este documento detalla los pasos para instalar y configurar el entorno de desarrollo necesario para la API, incluyendo la base de datos MySQL con XAMPP y el servidor de la API con FastAPI.

Paso 1: InstalaciÃ³n de XAMPP (Servidor Local)
XAMPP es un paquete de software gratuito que instala un servidor web (Apache) y una base de datos (MySQL) en tu computadora.

Descarga XAMPP: Ve al sitio web oficial de Apache Friends y descarga el instalador de XAMPP para tu sistema operativo.

Instala XAMPP: Ejecuta el instalador. Es recomendable usar la configuraciÃ³n por defecto. AsegÃºrate de que Apache y MySQL estÃ©n seleccionados para la instalaciÃ³n.

Paso 2: Iniciar la Base de Datos con XAMPP
Para que tu backend pueda conectarse a la base de datos, el servidor de MySQL debe estar en ejecuciÃ³n.

Abre el Panel de Control de XAMPP: Puedes encontrarlo en el menÃº de inicio de Windows.

Inicia los mÃ³dulos: En el panel de control, haz clic en el botÃ³n Start (Iniciar) junto a los mÃ³dulos Apache y MySQL. Una vez que se inicien, el nombre del mÃ³dulo y el botÃ³n se pondrÃ¡n en verde.

Paso 3: Crear la Base de Datos en phpMyAdmin
Tu cÃ³digo espera una base de datos con un nombre especÃ­fico, base_de_datos. Debes crearla manualmente.

Abre phpMyAdmin: En el Panel de Control de XAMPP, haz clic en el botÃ³n Admin junto al mÃ³dulo de MySQL. Esto abrirÃ¡ phpMyAdmin en tu navegador web.

Crea la base de datos: En la pÃ¡gina principal de phpMyAdmin, ve a la pestaÃ±a Bases de datos. En el campo de texto, escribe base_de_datos y haz clic en el botÃ³n Crear.

Paso 4: Configurar la ConexiÃ³n en la API (FastAPI)
La DATABASE_URL en tu cÃ³digo debe coincidir con la configuraciÃ³n por defecto de XAMPP.

Host: localhost

Usuario: root

ContraseÃ±a: No tiene (dÃ©jala vacÃ­a)

Puerto: 3306

Nombre de la BD: base_de_datos

Tu archivo database.py debe lucir asÃ­:

Python

# backend/database.py

DATABASE_URL = "mysql+mysqlconnector://root:@localhost:3306/base_de_datos"
# Si usas PyMySQL, cambia el conector
# DATABASE_URL = "mysql+pymysql://root:@localhost:3306/base_de_datos"
Paso 5: Iniciar el Servidor de FastAPI
Una vez que XAMPP estÃ© corriendo y la base de datos exista, puedes iniciar tu backend.

Abre tu terminal en la carpeta principal de tu proyecto.

Activa tu entorno virtual (venv).

Inicia el servidor: Ejecuta el siguiente comando para arrancar la API.

Bash

uvicorn main:app --reload
Verifica la conexiÃ³n: Si todo estÃ¡ configurado correctamente, el servidor se iniciarÃ¡ sin errores. La lÃ­nea Base.metadata.create_all() en tu main.py crearÃ¡ automÃ¡ticamente las tablas (como la tabla Usuario) dentro de la base de datos base_de_datos.